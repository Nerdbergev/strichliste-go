CREATE TABLE "user" (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, name VARCHAR(64) NOT NULL, email VARCHAR(255) DEFAULT NULL, balance INTEGER NOT NULL, disabled BOOLEAN NOT NULL, created DATETIME NOT NULL, updated DATETIME DEFAULT NULL);
CREATE UNIQUE INDEX UNIQ_8D93D6495E237E06 ON "user" (name);
CREATE INDEX disabled_updated ON "user" (disabled, updated);
CREATE TABLE article (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, precursor_id INTEGER DEFAULT NULL, name VARCHAR(255) NOT NULL, barcode VARCHAR(32) DEFAULT NULL, amount INTEGER NOT NULL, active BOOLEAN NOT NULL, created DATETIME NOT NULL, usage_count INTEGER NOT NULL, CONSTRAINT FK_23A0E66FA546BCC FOREIGN KEY (precursor_id) REFERENCES article (id) NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE UNIQUE INDEX UNIQ_23A0E66FA546BCC ON article (precursor_id);
CREATE TABLE transactions (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, user_id INTEGER NOT NULL, article_id INTEGER DEFAULT NULL, recipient_transaction_id INTEGER DEFAULT NULL, sender_transaction_id INTEGER DEFAULT NULL, quantity INTEGER DEFAULT NULL, comment VARCHAR(255) DEFAULT NULL, amount INTEGER NOT NULL, deleted BOOLEAN NOT NULL, created DATETIME NOT NULL, CONSTRAINT FK_EAA81A4CA76ED395 FOREIGN KEY (user_id) REFERENCES "user" (id) NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_EAA81A4C7294869C FOREIGN KEY (article_id) REFERENCES article (id) NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_EAA81A4C87F3EDB8 FOREIGN KEY (recipient_transaction_id) REFERENCES transactions (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE, CONSTRAINT FK_EAA81A4CFE2C36CC FOREIGN KEY (sender_transaction_id) REFERENCES transactions (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE);
CREATE INDEX IDX_EAA81A4CA76ED395 ON transactions (user_id);
CREATE INDEX IDX_EAA81A4C7294869C ON transactions (article_id);
CREATE UNIQUE INDEX UNIQ_EAA81A4C87F3EDB8 ON transactions (recipient_transaction_id);
CREATE UNIQUE INDEX UNIQ_EAA81A4CFE2C36CC ON transactions (sender_transaction_id);
